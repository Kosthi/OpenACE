Fix the bug described in the issue below.

## Issue Description
{problem_statement}

## Hints
{hints_text}
{context_section}
## Instructions
1. Analyze the issue and the relevant code carefully.
2. Identify the root cause of the bug.
3. Generate a minimal patch in unified diff format that fixes the issue.
4. The patch MUST use the standard unified diff format:
   - Start each file change with `diff --git a/path b/path`
   - Include `--- a/path` and `+++ b/path` headers
   - Include `@@ ... @@` hunk headers
   - Prefix removed lines with `-` and added lines with `+`
5. Only modify files that need to change. Keep changes minimal.
6. Output ONLY the patch. Do not include any explanation before or after.
